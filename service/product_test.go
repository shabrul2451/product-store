package service

import (
	"Product-Store/model"
	"Product-Store/utils/database"
	"github.com/google/uuid"
	"github.com/stretchr/testify/assert"
	"log"
	"reflect"
	"testing"
)

func initProductData() []model.ProductDto {
	data := []model.ProductDto{model.ProductDto{
		Id:             uuid.New().String(),
		Name:           "I phone",
		Description:    "This is an example product description.",
		Specifications: "Sample specifications",
		BrandId:        "b8341371-4d70-42a0-a6e8-bfed2e0e5cc5",
		CategoryId:     "6a233df1-b317-4be3-a2ae-8d02ea5205e3",
		SupplierId:     "ea33b52f-abe9-4f06-b01b-ed72cdf0cee9",
		UnitPrice:      30000,
		DiscountPrice:  2000,
		Tags:           "sample tag",
		StatusId:       1,
		StockQuantity:  10,
	}, {
		Id:             uuid.New().String(),
		Name:           "I phone x",
		Description:    "This is an example product description.",
		Specifications: "Sample specifications",
		BrandId:        "b8341371-4d70-42a0-a6e8-bfed2e0e5cc5",
		CategoryId:     "6a233df1-b317-4be3-a2ae-8d02ea5205e3",
		SupplierId:     "ea33b52f-abe9-4f06-b01b-ed72cdf0cee9",
		UnitPrice:      35000,
		DiscountPrice:  2000,
		Tags:           "sample tag",
		StatusId:       1,
		StockQuantity:  20,
	},
		{
			Id:             uuid.New().String(),
			Name:           "I phone 12",
			Description:    "This is an example product description.",
			Specifications: "Sample specifications",
			BrandId:        "b8341371-4d70-42a0-a6e8-bfed2e0e5cc5",
			CategoryId:     "6a233df1-b317-4be3-a2ae-8d02ea5205e3",
			SupplierId:     "ea33b52f-abe9-4f06-b01b-ed72cdf0cee9",
			UnitPrice:      45000,
			DiscountPrice:  2000,
			Tags:           "sample tag",
			StatusId:       1,
			StockQuantity:  10,
		},
		{
			Id:             uuid.New().String(),
			Name:           "I phone 15",
			Description:    "This is an example product description.",
			Specifications: "Sample specifications",
			BrandId:        "b8341371-4d70-42a0-a6e8-bfed2e0e5cc5",
			CategoryId:     "6a233df1-b317-4be3-a2ae-8d02ea5205e3",
			SupplierId:     "ea33b52f-abe9-4f06-b01b-ed72cdf0cee9",
			UnitPrice:      95000,
			DiscountPrice:  2000,
			Tags:           "sample tag",
			StatusId:       1,
			StockQuantity:  10,
		},
		{
			Id:             uuid.New().String(),
			Name:           "I phone",
			Description:    "This is an example product description.",
			Specifications: "Sample specifications",
			BrandId:        "b8341371-4d70-42a0-a6e8-bfed2e0e5cc5",
			CategoryId:     "6a233df1-b317-4be3-a2ae-8d02ea5205e3",
			SupplierId:     "ea33b52f-abe9-4f06-b01b-ed72cdf0cee9",
			UnitPrice:      30000,
			DiscountPrice:  2000,
			Tags:           "sample tag",
			StatusId:       1,
			StockQuantity:  10,
		},
		{
			Id:             uuid.New().String(),
			Name:           "flip 2",
			Description:    "This is an example product description.",
			Specifications: "Sample specifications",
			BrandId:        "c2f86c20-4740-45d3-a2e7-73d12d3d33c7",
			CategoryId:     "76d33749-54a6-4ae1-a6a7-182292e1efb4",
			SupplierId:     "ea33b52f-abe9-4f06-b01b-ed72cdf0cee9",
			UnitPrice:      30000,
			DiscountPrice:  2000,
			Tags:           "sample tag",
			StatusId:       1,
			StockQuantity:  10,
		},
		{
			Id:             uuid.New().String(),
			Name:           "galaxy 2",
			Description:    "This is an example product description.",
			Specifications: "Sample specifications",
			BrandId:        "c2f86c20-4740-45d3-a2e7-73d12d3d33c7",
			CategoryId:     "76d33749-54a6-4ae1-a6a7-182292e1efb4",
			SupplierId:     "ea33b52f-abe9-4f06-b01b-ed72cdf0cee9",
			UnitPrice:      25000,
			DiscountPrice:  2000,
			Tags:           "sample tag",
			StatusId:       1,
			StockQuantity:  10,
		},
		{
			Id:             uuid.New().String(),
			Name:           "note 2",
			Description:    "This is an example product description.",
			Specifications: "Sample specifications",
			BrandId:        "c2f86c20-4740-45d3-a2e7-73d12d3d33c7",
			CategoryId:     "76d33749-54a6-4ae1-a6a7-182292e1efb4",
			SupplierId:     "ea33b52f-abe9-4f06-b01b-ed72cdf0cee9",
			UnitPrice:      75000,
			DiscountPrice:  2000,
			Tags:           "sample tag",
			StatusId:       1,
			StockQuantity:  10,
		},
		{
			Id:             uuid.New().String(),
			Name:           "galaxy note 2",
			Description:    "This is an example product description.",
			Specifications: "Sample specifications",
			BrandId:        "c2f86c20-4740-45d3-a2e7-73d12d3d33c7",
			CategoryId:     "76d33749-54a6-4ae1-a6a7-182292e1efb4",
			SupplierId:     "ea33b52f-abe9-4f06-b01b-ed72cdf0cee9",
			UnitPrice:      25020,
			DiscountPrice:  2000,
			Tags:           "sample tag",
			StatusId:       1,
			StockQuantity:  10,
		},
		{
			Id:             uuid.New().String(),
			Name:           "galaxy 10",
			Description:    "This is an example product description.",
			Specifications: "Sample specifications",
			BrandId:        "c2f86c20-4740-45d3-a2e7-73d12d3d33c7",
			CategoryId:     "76d33749-54a6-4ae1-a6a7-182292e1efb4",
			SupplierId:     "ea33b52f-abe9-4f06-b01b-ed72cdf0cee9",
			UnitPrice:      25030,
			DiscountPrice:  2000,
			Tags:           "sample tag",
			StatusId:       1,
			StockQuantity:  10,
		},
		{
			Id:             uuid.New().String(),
			Name:           "nothing 10",
			Description:    "This is an example product description.",
			Specifications: "Sample specifications",
			BrandId:        "0becbcba-eaa5-41e6-8fcf-e5a0dc6ee471",
			CategoryId:     "76d33749-54a6-4ae1-a6a7-182292e1efb4",
			SupplierId:     "ea33b52f-abe9-4f06-b01b-ed72cdf0cee9",
			UnitPrice:      25040,
			DiscountPrice:  2000,
			Tags:           "sample tag",
			StatusId:       1,
			StockQuantity:  10,
		},
		{
			Id:             uuid.New().String(),
			Name:           "nothing 9",
			Description:    "This is an example product description.",
			Specifications: "Sample specifications",
			BrandId:        "0becbcba-eaa5-41e6-8fcf-e5a0dc6ee471",
			CategoryId:     "76d33749-54a6-4ae1-a6a7-182292e1efb4",
			SupplierId:     "ea33b52f-abe9-4f06-b01b-ed72cdf0cee9",
			UnitPrice:      25500,
			DiscountPrice:  2000,
			Tags:           "sample tag",
			StatusId:       1,
			StockQuantity:  10,
		},
		{
			Id:             uuid.New().String(),
			Name:           "nothing 8",
			Description:    "This is an example product description.",
			Specifications: "Sample specifications",
			BrandId:        "0becbcba-eaa5-41e6-8fcf-e5a0dc6ee471",
			CategoryId:     "76d33749-54a6-4ae1-a6a7-182292e1efb4",
			SupplierId:     "ea33b52f-abe9-4f06-b01b-ed72cdf0cee9",
			UnitPrice:      25600,
			DiscountPrice:  2000,
			Tags:           "sample tag",
			StatusId:       1,
			StockQuantity:  10,
		},
		{
			Id:             uuid.New().String(),
			Name:           "oppo 10",
			Description:    "This is an example product description.",
			Specifications: "Sample specifications",
			BrandId:        "a3325b39-aaf7-45cf-b59a-82dc8fe28234",
			CategoryId:     "76d33749-54a6-4ae1-a6a7-182292e1efb4",
			SupplierId:     "ea33b52f-abe9-4f06-b01b-ed72cdf0cee9",
			UnitPrice:      25700,
			DiscountPrice:  2000,
			Tags:           "sample tag",
			StatusId:       1,
			StockQuantity:  10,
		},
		{
			Id:             uuid.New().String(),
			Name:           "oppo 9",
			Description:    "This is an example product description.",
			Specifications: "Sample specifications",
			BrandId:        "a3325b39-aaf7-45cf-b59a-82dc8fe28234",
			CategoryId:     "76d33749-54a6-4ae1-a6a7-182292e1efb4",
			SupplierId:     "ea33b52f-abe9-4f06-b01b-ed72cdf0cee9",
			UnitPrice:      25800,
			DiscountPrice:  2000,
			Tags:           "sample tag",
			StatusId:       1,
			StockQuantity:  10,
		},
		{
			Id:             uuid.New().String(),
			Name:           "samsung 10",
			Description:    "This is an example product description.",
			Specifications: "Sample specifications",
			BrandId:        "c2f86c20-4740-45d3-a2e7-73d12d3d33c7",
			CategoryId:     "005886a0-badf-4c03-bcc2-1aa910db9433",
			SupplierId:     "241acb7f-9b2b-4e97-96a5-830e0b076d53",
			UnitPrice:      25900,
			DiscountPrice:  2000,
			Tags:           "sample tag",
			StatusId:       1,
			StockQuantity:  10,
		},
		{
			Id:             uuid.New().String(),
			Name:           "samsung 9",
			Description:    "This is an example product description.",
			Specifications: "Sample specifications",
			BrandId:        "c2f86c20-4740-45d3-a2e7-73d12d3d33c7",
			CategoryId:     "005886a0-badf-4c03-bcc2-1aa910db9433",
			SupplierId:     "241acb7f-9b2b-4e97-96a5-830e0b076d53",
			UnitPrice:      25500,
			DiscountPrice:  2000,
			Tags:           "sample tag",
			StatusId:       1,
			StockQuantity:  10,
		},
		{
			Id:             uuid.New().String(),
			Name:           "samsung 8",
			Description:    "This is an example product description.",
			Specifications: "Sample specifications",
			BrandId:        "c2f86c20-4740-45d3-a2e7-73d12d3d33c7",
			CategoryId:     "005886a0-badf-4c03-bcc2-1aa910db9433",
			SupplierId:     "241acb7f-9b2b-4e97-96a5-830e0b076d53",
			UnitPrice:      25650,
			DiscountPrice:  2000,
			Tags:           "sample tag",
			StatusId:       1,
			StockQuantity:  10,
		},
		{
			Id:             uuid.New().String(),
			Name:           "samsung 7",
			Description:    "This is an example product description.",
			Specifications: "Sample specifications",
			BrandId:        "c2f86c20-4740-45d3-a2e7-73d12d3d33c7",
			CategoryId:     "005886a0-badf-4c03-bcc2-1aa910db9433",
			SupplierId:     "241acb7f-9b2b-4e97-96a5-830e0b076d53",
			UnitPrice:      25750,
			DiscountPrice:  2000,
			Tags:           "sample tag",
			StatusId:       1,
			StockQuantity:  10,
		},
		{
			Id:             uuid.New().String(),
			Name:           "samsung 6",
			Description:    "This is an example product description.",
			Specifications: "Sample specifications",
			BrandId:        "c2f86c20-4740-45d3-a2e7-73d12d3d33c7",
			CategoryId:     "005886a0-badf-4c03-bcc2-1aa910db9433",
			SupplierId:     "241acb7f-9b2b-4e97-96a5-830e0b076d53",
			UnitPrice:      25850,
			DiscountPrice:  2000,
			Tags:           "sample tag",
			StatusId:       1,
			StockQuantity:  10,
		},
		{
			Id:             uuid.New().String(),
			Name:           "samsung 5",
			Description:    "This is an example product description.",
			Specifications: "Sample specifications",
			BrandId:        "c2f86c20-4740-45d3-a2e7-73d12d3d33c7",
			CategoryId:     "005886a0-badf-4c03-bcc2-1aa910db9433",
			SupplierId:     "241acb7f-9b2b-4e97-96a5-830e0b076d53",
			UnitPrice:      25950,
			DiscountPrice:  2000,
			Tags:           "sample tag",
			StatusId:       1,
			StockQuantity:  10,
		},
	}
	return data
}

func TestCreate(t *testing.T) {
	data := initProductData()
	nps := NewProductService(database.NewProductRepository(), database.NewSupplierRepository(), database.NewProductStockRepository(), database.NewBrandRepository(), database.NewCategoriesRepository())

	for _, each := range data {
		err := nps.Create(each)
		if err != nil {
			log.Println(err)
		}
	}
	products := nps.Get()
	if !reflect.DeepEqual(data, products) {
		assert.Len(t, data, len(products)+1)
	}
}
